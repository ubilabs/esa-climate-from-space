import React, {CSSProperties, FunctionComponent, HTMLAttributes} from 'react';
import {MethaneSources, MethaneSourceType} from '../../../types/globe';

import cx from 'classnames';

import styles from './methane-source-icon.module.styl';

interface Props extends Omit<HTMLAttributes<HTMLDivElement>, 'style'> {
  source: MethaneSources;
  percentage: number;
  sourceType: MethaneSourceType;
  isSelected: boolean;
  yValue: number;
}

const getIcon = (source: MethaneSources) => {
  switch (source) {
    case MethaneSources.BURNING:
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="24px"
          viewBox="0 -960 960 960"
          width="24px"
          fill="currentColor">
          <path d="M200-400q0 52 21 98.5t60 81.5q-1-5-1-9v-9q0-32 12-60t35-51l113-111 113 111q23 23 35 51t12 60v9q0 4-1 9 39-35 60-81.5t21-98.5q0-50-18.5-94.5T608-574q-20 13-42 19.5t-45 6.5q-62 0-107.5-41T361-690q-39 33-69 68.5t-50.5 72Q221-513 210.5-475T200-400Zm240 52-57 56q-11 11-17 25t-6 29q0 32 23.5 55t56.5 23q33 0 56.5-23t23.5-55q0-16-6-29.5T497-292l-57-56Zm0-492v132q0 34 23.5 57t57.5 23q18 0 33.5-7.5T582-658l18-22q74 42 117 117t43 163q0 134-93 227T440-80q-134 0-227-93t-93-227q0-129 86.5-245T440-840Zm400 320q-17 0-28.5-11.5T800-560q0-17 11.5-28.5T840-600q17 0 28.5 11.5T880-560q0 17-11.5 28.5T840-520Zm-40-120v-200h80v200h-80Z" />
        </svg>
      );
    case MethaneSources.TRANSPORTATION:
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="45"
          height="46"
          viewBox="0 0 45 46"
          fill="none">
          <path
            d="M30.1335 12.0344L27.2083 18.189L29.5096 21.6008C29.6874 21.8644 29.747 22.1469 29.6885 22.4483C29.6299 22.7496 29.4688 22.9892 29.2052 23.167C28.9416 23.3448 28.6591 23.4044 28.3577 23.3458C28.0564 23.2872 27.8168 23.1261 27.639 22.8626L25.3377 19.4507L18.5355 19.8574L17.9304 18.9603L23.7634 17.1167L21.4305 13.6581L19.7659 13.5747L19.2354 12.7882L21.6876 12.0218L23.3168 10.0352L23.8473 10.8217L23.3011 12.3964L25.634 15.855L29.5284 11.1374L30.1335 12.0344ZM27.3928 27.0462L21.5598 28.8898L23.8927 32.3484L25.5573 32.4319L26.0878 33.2184L23.6355 33.9848L22.0064 35.9713L21.4758 35.1848L22.022 33.6102L19.6892 30.1516L15.7948 34.8692L15.1897 33.9722L18.1149 27.8176L15.8136 24.4058C15.6358 24.1422 15.5762 23.8597 15.6347 23.5583C15.6933 23.2569 15.8544 23.0173 16.118 22.8396C16.3816 22.6618 16.6641 22.6022 16.9654 22.6607C17.2668 22.7193 17.5064 22.8804 17.6842 23.144L19.9855 26.5558L26.7877 26.1492L27.3928 27.0462Z"
            fill="currentColor"
          />
        </svg>
      );
    case MethaneSources.CONSTRUCTION:
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          height="24px"
          viewBox="0 -960 960 960"
          width="24px"
          fill="currentColor">
          <path d="M120-120v-560h160v-160h400v320h160v400H520v-160h-80v160H120Zm80-80h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 320h80v-80h-80v80Zm0-160h80v-80h-80v80Zm0-160h80v-80h-80v80Zm160 480h80v-80h-80v80Zm0-160h80v-80h-80v80Z" />
        </svg>
      );
    case MethaneSources.FACTORIES:
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="32"
          height="33"
          viewBox="0 0 32 33"
          fill="none">
          <path
            d="M3.33398 29.1666L3.33398 14.2487L11.3339 10.8462L11.3339 13.4872L18.0006 10.8206V14.5L28.6673 14.5L28.6673 29.1666L3.33398 29.1666ZM5.33395 27.1666L26.6673 27.1666V16.5L16.0006 16.5V13.7666L9.33395 16.4333V13.8333L5.33395 15.6L5.33395 27.1666ZM14.8212 24.1923H17.1801L17.1801 19.4743H14.8212L14.8212 24.1923ZM9.48782 24.1923H11.8468L11.8468 19.4743H9.48782V24.1923ZM20.1545 24.1923H22.5134V19.4743H20.1545V24.1923ZM28.6673 14.5H23.2571L24.5904 4.34619H27.4108L28.6673 14.5Z"
            fill="currentColor"
          />
        </svg>
      );
    case MethaneSources.LANDFILLS:
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="33"
          height="33"
          viewBox="0 0 33 33"
          fill="none">
          <path
            d="M2.86914 28.8508L9.66391 19.774L14.9715 26.8508L25.6639 26.8508L18.9972 17.9841L15.3305 22.8457L14.0742 21.1842L18.9972 14.6201L29.6638 28.8508L2.86914 28.8508Z"
            fill="currentColor"
          />
          <path
            d="M29.0648 10.4842L26.5981 12.938L26.5981 6.87645L24.5981 6.87645L24.5981 12.9175L22.1314 10.4508L20.7392 11.8764L25.5981 16.7354L30.457 11.8764L29.0648 10.4842Z"
            fill="currentColor"
          />
        </svg>
      );
    case MethaneSources.OIL:
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="32"
          height="32"
          viewBox="0 0 32 32"
          fill="none">
          <path
            d="M5.65426 27.3331C5.37093 27.3331 5.13344 27.2372 4.9418 27.0455C4.75013 26.8537 4.6543 26.6161 4.6543 26.3327C4.6543 26.0492 4.75013 25.8118 4.9418 25.6203C5.13344 25.4289 5.37093 25.3331 5.65426 25.3331H7.12863L7.12863 16.9998H5.65426C5.37093 16.9998 5.13344 16.9039 4.9418 16.7122C4.75013 16.5204 4.6543 16.2828 4.6543 15.9994C4.6543 15.7159 4.75013 15.4784 4.9418 15.287C5.13344 15.0956 5.37093 14.9998 5.65426 14.9998H7.12863L7.12863 6.66647H5.65426C5.37093 6.66647 5.13344 6.57059 4.9418 6.37884C4.75013 6.1871 4.6543 5.9495 4.6543 5.66604C4.6543 5.38259 4.75013 5.14515 4.9418 4.9537C5.13344 4.76224 5.37093 4.6665 5.65426 4.6665L26.3337 4.6665C26.617 4.6665 26.8545 4.76238 27.0462 4.95414C27.2379 5.14589 27.3337 5.38349 27.3337 5.66694C27.3337 5.9504 27.2379 6.18786 27.0462 6.37931C26.8545 6.57075 26.617 6.66647 26.3337 6.66647H24.8722V14.9998H26.3337C26.617 14.9998 26.8545 15.0957 27.0462 15.2874C27.2379 15.4792 27.3337 15.7168 27.3337 16.0002C27.3337 16.2837 27.2379 16.5212 27.0462 16.7126C26.8545 16.904 26.617 16.9998 26.3337 16.9998H24.8722V25.3331H26.3337C26.617 25.3331 26.8545 25.429 27.0462 25.6208C27.2379 25.8125 27.3337 26.0501 27.3337 26.3336C27.3337 26.617 27.2379 26.8545 27.0462 27.0459C26.8545 27.2374 26.617 27.3331 26.3337 27.3331L5.65426 27.3331ZM9.1286 25.3331L22.8722 25.3331V16.9998H22.5389C22.2555 16.9998 22.018 16.9039 21.8264 16.7122C21.6347 16.5204 21.5389 16.2828 21.5389 15.9994C21.5389 15.7159 21.6347 15.4784 21.8264 15.287C22.018 15.0956 22.2555 14.9998 22.5389 14.9998H22.8722V6.66647L9.1286 6.66647L9.1286 14.9998H9.46193C9.74526 14.9998 9.98276 15.0957 10.1744 15.2874C10.3661 15.4792 10.4619 15.7168 10.4619 16.0002C10.4619 16.2837 10.3661 16.5212 10.1744 16.7126C9.98276 16.904 9.74526 16.9998 9.46193 16.9998H9.1286L9.1286 25.3331ZM15.9989 20.91C17.017 20.91 17.8829 20.5586 18.5965 19.8558C19.3102 19.153 19.667 18.3025 19.667 17.3043C19.667 16.5099 19.4379 15.8275 18.9795 15.2571C18.5212 14.6868 17.5282 13.5156 16.0004 11.7434C14.479 13.5007 13.4876 14.6691 13.0261 15.2487C12.5645 15.8282 12.3338 16.5146 12.3338 17.3077C12.3338 18.3041 12.6901 19.1536 13.4028 19.8562C14.1154 20.5588 14.9808 20.91 15.9989 20.91Z"
            fill="currentColor"
          />
        </svg>
      );
    case MethaneSources.LIVESTOCK:
      return (
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="54"
          height="39"
          viewBox="0 0 54 39"
          fill="none">
          <path
            fillRule="evenodd"
            clipRule="evenodd"
            d="M40.8885 0.340193C41.3149 -0.10639 42.014 -0.114317 42.45 0.322486C43.3658 1.24006 43.9999 2.41288 44.273 3.69463C44.3443 4.0291 44.2639 4.37864 44.0543 4.64529C43.8447 4.91193 43.5285 5.06698 43.1943 5.06698L34.4166 5.06698L18.1005 6.74324C18.0282 6.75067 17.9553 6.75076 17.8829 6.74352L7.94894 5.74875L7.94712 5.74858C5.83992 5.54618 3.93732 7.04027 3.5791 9.17459C3.25915 11.583 3.0265 14.0024 2.88178 16.4275C3.06962 16.0792 3.43154 15.8431 3.84748 15.8426C4.4573 15.8417 4.95231 16.3475 4.95311 16.9722C4.95607 19.2661 5.47788 21.5273 6.47856 23.579L6.75642 24.1486L3.81246 28.9352L3.81246 33.2438L5.33785 36.3752H6.5692L6.02056 35.2664L6.02056 30.327L13.1897 22.9911L13.727 21.895C14.0006 21.3368 14.6643 21.1115 15.2092 21.3918C15.7542 21.6721 15.9741 22.352 15.7005 22.9102L15.5419 23.2337C16.5379 23.3721 17.523 23.471 18.4925 23.5083C18.6099 23.4743 18.7348 23.4599 18.8634 23.4684C18.9605 23.4748 19.0539 23.4938 19.1421 23.5239C21.2144 23.5425 23.2092 23.253 25.0785 22.4359C25.0782 22.4251 25.078 22.4143 25.078 22.4034V22.3329C25.0316 21.5273 25.1581 20.7203 25.4519 19.969C25.6786 19.3891 26.3213 19.1073 26.8874 19.3395C27.4535 19.5718 27.7286 20.2302 27.5019 20.8101C27.327 21.2573 27.2527 21.7397 27.284 22.2229L27.2864 22.2602V22.2837L27.8958 25.3235L27.8998 25.35C28.1664 27.0957 28.9086 28.7287 30.0411 30.0601L30.3127 30.3795L30.3127 36.3752H32.4478V36.0985L31.6305 34.4168L31.6304 34.1511C31.6296 31.8295 31.9074 29.5172 32.4581 27.265L32.4586 27.2629L33.4061 23.3288L33.8344 23.0905C37.0699 21.2907 39.4517 18.2203 40.4299 14.5844L40.4965 14.3366C40.2339 14.0813 40.0012 13.8348 39.7961 13.6174C39.6305 13.442 39.4829 13.2855 39.352 13.159C38.9085 12.7302 38.8883 12.0143 39.3069 11.56C39.7255 11.1058 40.4244 11.0851 40.8678 11.5139C41.073 11.7123 41.2734 11.9179 41.4736 12.1233C42.7331 13.4157 43.9822 14.6973 46.3305 14.0835L47.2815 13.7237L50.3381 13.7237L50.3509 13.6901C50.5722 13.108 51.2122 12.8198 51.7805 13.0465C52.3487 13.2732 52.63 13.9289 52.4087 14.511L51.848 15.9859L47.6762 15.9859L46.9946 16.2437L46.9437 16.2575C45.0627 16.7669 43.5665 16.4147 42.3886 15.7743C41.2095 19.5847 38.6897 22.8123 35.3192 24.8298L34.6013 27.8107L34.6008 27.8127C34.1146 29.8003 33.8594 31.8389 33.84 33.8872L34.6561 35.5666V36.3752H52.3957C53.0056 36.3752 53.4999 36.8816 53.4999 37.5063C53.4999 38.131 53.0056 38.6374 52.3957 38.6374H34.6561V38.6456H28.1044V38.6374L9.05342 38.6374L9.05342 38.6757H3.99041L3.97179 38.6374H1.60418C0.994356 38.6374 0.5 38.131 0.5 37.5063C0.5 36.8816 0.994356 36.3752 1.60418 36.3752H2.86984L1.60411 33.7768L1.60411 28.282L4.2326 24.0083C3.42335 22.1797 2.93602 20.221 2.7908 18.2221C2.74632 19.2878 2.71882 20.3543 2.70835 21.4213V22.4034C2.70835 23.0281 2.214 23.5345 1.60418 23.5345C0.994356 23.5345 0.5 23.0281 0.5 22.4034L0.5 21.4156C0.5 21.4118 0.500018 21.4081 0.500055 21.4043C0.541029 17.2046 0.839892 13.0116 1.3934 8.85083C1.39494 8.83928 1.39665 8.82775 1.39853 8.81626C1.94158 5.50325 4.89018 3.18135 8.15608 3.49654L8.15994 3.49691L17.9889 4.48116L34.2512 2.81044C34.2878 2.80668 34.3246 2.80479 34.3614 2.80479L41.5779 2.80479C41.3907 2.4906 41.1653 2.1997 40.9058 1.93971C40.4699 1.5029 40.4621 0.786776 40.8885 0.340193ZM14.0625 25.2954C15.1625 25.4766 16.2863 25.6279 17.4202 25.7129C16.8771 27.0463 15.5983 27.9767 14.1152 27.9901C13.3795 27.9872 12.6709 27.7499 12.0819 27.322L14.0625 25.2954ZM14.1154 30.2523C12.7897 30.2492 11.5183 29.7774 10.5057 28.9349L8.22891 31.2647V34.7258L9.045 36.3752L28.1044 36.3752L28.1044 31.2145C26.8567 29.6323 26.0344 27.7402 25.7222 25.7267L25.5155 24.6959C23.6294 25.4462 21.6745 25.7479 19.7211 25.7834C19.0734 28.3532 16.8062 30.2321 14.1261 30.2523L14.1208 30.2524L14.1154 30.2523Z"
            fill="currentColor"
          />
          <path
            d="M48.2773 3.03639C48.5531 2.66425 48.9977 2.466 49.4518 2.51282C50.0585 2.57538 50.5999 2.12224 50.661 1.5007C50.7221 0.879152 50.2797 0.324569 49.673 0.262001C48.4815 0.139134 47.3129 0.64523 46.5689 1.60202L45.5573 2.63822V4.57969L48.0395 6.2696C48.2115 8.50496 49.3121 10.57 51.0772 11.9283L51.0929 11.9404L51.7644 12.4198C52.2647 12.777 52.9529 12.6511 53.3016 12.1386C53.6503 11.6261 53.5274 10.9211 53.0271 10.5639L52.3886 10.108C51.0247 9.05096 50.2228 7.39992 50.2241 5.64795L50.2246 5.04102L47.8878 3.45011L48.2318 3.09776L48.2773 3.03639Z"
            fill="currentColor"
          />
          <path
            d="M46.8752 8.09792C46.8752 8.72257 46.3808 9.22895 45.7711 9.22895C45.1613 9.22895 44.6669 8.72257 44.6669 8.09792C44.6669 7.47327 45.1613 6.96689 45.7711 6.96689C46.3808 6.96689 46.8752 7.47327 46.8752 8.09792Z"
            fill="currentColor"
          />
        </svg>
      );
    default:
      return null;
  }
};
export const MethaneSourcesIcon: FunctionComponent<Props> = ({
  source,
  percentage,
  sourceType,
  isSelected,
  yValue,
  ...rest
}) => {
  const diameter = isSelected ? 120 : 80;
  const radius = diameter / 2;

  const circumference = 2 * Math.PI * radius;
  const offset = circumference - (percentage / 100) * circumference;

  const cssProperties = {
    '--y-offset': `${yValue}px`
  } as CSSProperties;

  return (
    <div
      className={styles.methaneSourcesIcon}
      style={{...cssProperties}}
      {...rest}>
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width={`${diameter}`}
        height={`${diameter}`}
        viewBox={`0 0 ${diameter} ${diameter}`}
        fill="none">
        <circle
          cx={`${radius}`}
          cy={`${radius}`}
          r={`${radius - 2}`}
          fill="rgba(0, 51, 73, 1)"
        />
        <circle
          cx={`${radius}`}
          cy={`${radius}`}
          r={`${radius - 2}`}
          fill="none"
          stroke="rgba(0, 0, 0, 0.54)"
          strokeWidth="5"
          transform={`rotate(-90 ${radius} ${radius})`}
        />
        <circle
          cx={`${radius}`}
          cy={`${radius}`}
          r={`${radius - 2}`}
          fill="none"
          stroke={
            sourceType === MethaneSourceType.ANTHROPHOGENIC
              ? 'var(--methane-src-ant-color)'
              : 'var(--methane-src-natural-color)'
          }
          strokeWidth="5"
          strokeDasharray={circumference}
          strokeDashoffset={offset}
          transform={`rotate(-90 ${radius} ${radius})`}
        />
      </svg>
      {
        <div
          className={cx(
            styles.sourceSymbolWrapper,
            isSelected && styles.isSelected
          )}>
          {getIcon(source)}
        </div>
      }
    </div>
  );
};
